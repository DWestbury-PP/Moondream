# Fast API service build using optimized base
FROM moondream-base:latest

# Switch back to root to copy files (then switch back to appuser)
USER root

# Copy application code
COPY services/ ./services/
COPY env.example .env

# Set ownership and switch back to non-root user
RUN chown -R appuser:appuser /app
USER appuser

# Expose ports
EXPOSE 8000 8001

# Run the API service
CMD ["python", "-m", "services.api.rest_api"]
